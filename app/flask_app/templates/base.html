<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>3D Precipitation & Reflectivity Visualization System</title>

  <!-- Bootstrap/JQuery Requirements -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  
  <!-- React Requirements -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <script src='https://unpkg.com/babel-standalone@6.26.0/babel.js'></script>

  <!-- Tempus Dominus Requirements -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.11/dist/js/tempus-dominus.min.js"
    crossorigin="anonymous"></script>
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.11/dist/css/tempus-dominus.min.css"
    crossorigin="anonymous">

  <!-- Plotly Requirements -->
  <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>

  <!-- Custom Style / Scripts -->
  <link rel="stylesheet" href="{{url_for('static', filename='css/styles.css')}}">
  <script src="{{url_for('static', filename='scripts.js')}}"></script>
  <script src="{{url_for('static', filename='ztext.min.js')}}"></script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="{{url_for('static', filename='cisess_logo_white.png')}}">
</head>

<body>
  <div class="sticky-top">
    <nav class="navbar navbar-expand-lg navbar-light bg-primary">
        <a class="navbar-brand text-white display-1" href="/">
            3DVisSys
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="fa fa-bars text-white"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end pt-1 pb-1" id="navbarNavDropdown">
            <ul class="navbar-nav">
                <li class="nav-item active mx-1">
                    <a class="nav-link rounded bg-primary text-white" href="/">
                        Home <span class="sr-only">(current)</span>
                    </a>
                </li>
                <li class="nav-item dropdown mx-1">
                    <a class="nav-link rounded dropdown-toggle bg-primary text-white" href="#"
                        id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Data
                    </a>
                    <div class="dropdown-menu bg-primary" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item text-white" href="https://mrms.ncep.noaa.gov/data/" target="_blank">
                            NOAA MRMS</a>
                        <a class="dropdown-item text-white" href="https://nominatim.org/release-docs/latest/api/Overview/"
                            target="_blank">
                            OpenStreetMap</a>
                    </div>
                </li>
                <li class="nav-item mx-1">
                    <a class="nav-link rounded bg-primary text-white" target="_blank" href="https://github.com/lanceu0128/3dvissys">
                        <span class="fab fa-github"></span>
                    </a>
                </li>
                <li class="nav-item mx-1">
                    <a class="nav-link rounded bg-primary text-white" href="mailto:marulraj@umd.edu?cc=lpu@umd.edu">
                        <span class="fa fa-envelope"></span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
  </div>
  <div class="container-fluid mt-0">
    <div class="row">
      <div class="col-md-3 bg-info">
        <div class="mt-3 btn-group btn-block">
          <button type="button" class="radio btn {% if graph_type == '2Dprecip' %}btn-primary{% else %}btn-light{% endif %}" onclick="handle_graph_selection(this, '2Dprecip')">
            <h3><i class="fa-solid fa-table-cells-large"></i></h3>
            Precipitation
          </button>
          <button type="button" class="radio btn {% if graph_type == '3Drefl' %}btn-primary{% else %}btn-light{% endif %}" onclick="handle_graph_selection(this, '3Drefl')">
            <h3><i class="fa-solid fa-cube"></i></h3>
            Reflectivity
          </button>
          <button type="button" class="radio btn {% if graph_type == '3Danim' %}btn-primary{% else %}btn-light{% endif %}" onclick="handle_graph_selection(this, '3Danim')">
            <h3><i class="fa-solid fa-cubes"></i></h3>
            Layered
          </button>
        </div>
        
        <form id="form" method="get">
          <div id="dateTimePicker" class="mt-3 bg-info">
          </div>
          
          <button type="button" class="btn btn-light mt-3 mx-auto w-100 d-flex justify-content-between" onclick="get_graph_by_date()">
            <span>Get Graph from Selected Date</span>
            <span><i class="fa-solid fa-calendar-day"></i></span>
          </button>
          
          <button type="button" class="btn btn-light mt-3 mx-auto w-100 d-flex justify-content-between" onclick="get_latest_graph()">
            <span>Get Latest Graph</span>
            <span><i class="fa-solid fa-satellite-dish"></i></span>
          </button>
        </form>
        
        <div style="height: 25vh;"></div>
      </div>
      
      <div id="content" class="col-md-9 mt-5 px-5 pb-5 min-vh-100">
        {% block content %}{% endblock %}  
      </div>
      
      <div id="modalContainer"></div>
    </div>
  </div>

  <footer class="footer bg-light py-4 mx-0 px-0">
    <div class="container-fluid row w-100 mx-0 px-0">
      <div class="col-2 text-center">
        <a href="https://cisess.umd.edu/"><img src="{{url_for('static', filename='cisessLogo.png')}}" height=100 alt="Center Image">
        </a>
      </div>
      <div class="col-8 text-center my-auto">
        <p>3DVisSys was developed by Lance Uymatiao and Malarvizhi Arulraj.</p>
        <p>Contact at <a href="mailto:lpu@umd.edu">lpu@umd.edu</a> and <a href="mailto:marulraj@umd.edu">marulraj.umd.edu</a></p>
      </div>
      <div class="col-2 text-center">
        <a href="https://www.noaa.gov/"><img src="{{url_for('static', filename='noaaLogo.png')}}" height=100 alt="Center Image">
        </a>
      </div>
    </div>
  </footer>

  <script type="text/javascript" defer>
    var graph_type = "{{ graph_type | safe }}"
    var valid_dates = convert_to_dates({{ valid_dates | safe }})
    console.log(valid_dates)

    dateTimePicker = new tempusDominus.TempusDominus(document.getElementById('dateTimePicker'), {
      display: {
        inline: true,
        theme: 'light',
      },
      restrictions: {
        enabledDates: valid_dates
      }
    })

    if ($("#graph").length) {
      var graph = {{ graphJSON | safe}}
      Plotly.plot('graph', graph)
      $('#loading-icon').hide()
    }
 
    $("#dateTimePicker").addClass("bg-light")
  </script>
    
    <!-- Render React components -->
    <script async src="{{url_for('static', filename='components/LoadingModal.jsx')}}" type="text/babel"></script>
</body>

</html>